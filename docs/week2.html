<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 2 Week 2 | UW CSDE 502 A Course Notes</title>
<meta name="author" content="Phil Hurvitz">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 2 Week 2 | UW CSDE 502 A Course Notes">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 Week 2 | UW CSDE 502 A Course Notes">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.20/datatables.js"></script><link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><meta name="description" content="Topics:  Code blocks in R Markdown Introduction to R/RStudio/RMarkdown R data types R data structures File systems Data sets: Employee turnover data Graphs in R Markdown Tables in R Markdown...">
<meta property="og:description" content="Topics:  Code blocks in R Markdown Introduction to R/RStudio/RMarkdown R data types R data structures File systems Data sets: Employee turnover data Graphs in R Markdown Tables in R Markdown...">
<meta name="twitter:description" content="Topics:  Code blocks in R Markdown Introduction to R/RStudio/RMarkdown R data types R data structures File systems Data sets: Employee turnover data Graphs in R Markdown Tables in R Markdown...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">UW CSDE 502 A Course Notes</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled"><li><a class="" href="index.html"><span class="header-section-number">Chapter 2</span> Week 2</a></li></ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/CSDE-UW/csde502-winter-2022">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="week2" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> Week 2<a class="anchor" aria-label="anchor" href="#week2"><i class="fas fa-link"></i></a>
</h1>
<h2>
Topics:
<a class="anchor" aria-label="anchor" href="#week2"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><a href="week1.html#gettingstarted">Code blocks in R Markdown</a></li>
<li><a href="week1.html#intrormd">Introduction to R/RStudio/RMarkdown</a></li>
<li><a href="week1.html#rdatatypes">R data types</a></li>
<li><a href="week1.html#rdatastructures">R data structures</a></li>
<li><a href="week1.html#filesystems">File systems</a></li>
<li>
<a href="week1.html#datasets001">Data sets:</a>
<ul>
<li><p>Employee turnover data</p></li>
<li>
<li><p>Graphs in R Markdown</p></li>
<li><p>Tables in R Markdown</p></li>
<li><p>Equations in R Markdown</p></li>
<li><p>HTML output from R Markdown</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/keyring/">Keyring: securely store secrets</a></p></li>
<li>
<p>Data:</p>
<ul>
<li><a href="https://www.mortality.org/">Human Mortality Database</a></li>
<li><a href="https://www.humanfertility.org/cgi-bin/main.php">Human Fertility Database</a></li>
<li>
<a href="https://cran.r-project.org/web/packages/HMDHFDplus/index.html">HMDHFDplus: Read Human Mortality Database and Human Fertility Database Data from the Web</a>
<a href="https://github.com/hanowell/uwsoc533a/blob/main/gists/HMDHFDplus-gist.R">Ben’s code for reading HMD and HFD data</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>ADD purrr! <a href="https://r4ds.had.co.nz/iteration.html" class="uri">https://r4ds.had.co.nz/iteration.html</a></p>
<h2>
Topics: R data structures; tidyverse
<a class="anchor" aria-label="anchor" href="#week2"><i class="fas fa-link"></i></a>
</h2>
<p>It is assumed that students in this course have a basic working knowledge of using R, including how to create variables with the assignment operator (“<code>&lt;-</code>”), and how to run simple functions(e.g., <code>mean(dat$age)</code>). Often in courses that include using R for statistical analysis, some of the following foundations are not explained fully. This is not intended to be a comprehensive treatment of R data types and structures, but should provide some background for students who are either relatively new at using R or who have not had a systematic introduction.</p>
<p>The other main topic for today is <a href="https://www.tidyverse.org/">“tidyverse”</a>, which refers to a related set of R packages for data management, analysis, and display. See Hadley Wickham’s <a href="https://tidyverse.tidyverse.org/articles/manifesto.html">tidy tools manifesto</a> for the logic behind the suite of tools. For a brief description of the specific R packages, see <a href="https://www.tidyverse.org/packages/">Tidyverse packages</a>. This is not intended to be a comprehensive introduction, but should provide sufficient background for data handling to support most of the technical aspects of the rest of the course.</p>
<div id="code-to-run-for-the-in-class-exercise" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Code to run for the in-class exercise<a class="anchor" aria-label="anchor" href="#code-to-run-for-the-in-class-exercise"><i class="fas fa-link"></i></a>
</h2>
<p>For the exercise in class, download <a href="r_code/week02.R">week02.R</a>, which we will use to run the code listed in this R Markdown result.</p>
</div>
<div id="rmarkdown" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Rmarkdown<a class="anchor" aria-label="anchor" href="#rmarkdown"><i class="fas fa-link"></i></a>
</h2>
<div id="rmdcodeblocks" class="section level3" number="2.2.1">
<h3>
<span class="header-section-number">2.2.1</span> Code blocks<a class="anchor" aria-label="anchor" href="#rmdcodeblocks"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="rmdgraphics" class="section level3" number="2.2.2">
<h3>
<span class="header-section-number">2.2.2</span> Graphics in R Markdown<a class="anchor" aria-label="anchor" href="#rmdgraphics"><i class="fas fa-link"></i></a>
</h3>
<p>Data-driven graphics in Rmd files are typically created as base R graphics or with the <code>ggplot2</code> package. This tutorial is not intended to provide anywhere near a comprehensive treatment of creating graphics from data, but will provide instruction on some options for creating and including data-driven graphics as well as inserting graphics from image files.</p>
<p>See <a href="http://zevross.com/blog/2017/06/19/tips-and-tricks-for-working-with-images-and-figures-in-r-markdown-documents/">Tips and tricks for working with images and figures in R Markdown documents</a> for a good explanation.</p>
<div id="base-r-graphics" class="section level4" number="2.2.2.1">
<h4>
<span class="header-section-number">2.2.2.1</span> Base R graphics<a class="anchor" aria-label="anchor" href="#base-r-graphics"><i class="fas fa-link"></i></a>
</h4>
<p>To include base R graphics, simply place the code to generate the graphic in an R code block, e.g., using the Add Health data from last week (<a href="data/AHWave1_v1.dta">AHWave1_v1.dta</a>):</p>
<pre><code>```{r}
# since loading the data takes awhile, only do this if necessary
if(!exists("dat")){
    dat &lt;- read.dta13("data/AHwave1_v1.dta")
}
# birth year = h1gi1y
# drop "Refused" birth year
# for birth year and interview year, replace anything before white space, convert to numeric
# subtract interview year - birth year
ages &lt;- dat %&gt;% 
    filter(! str_detect(h1gi1y, "Refused")) %&gt;% 
    select(iyear, h1gi1y) %&gt;% 
    mutate(yi = str_replace(iyear, ".*\\s", "") %&gt;% as.numeric(),
           yb = str_replace(h1gi1y, ".*\\s", "") %&gt;% as.numeric(),
           age = yi - yb)
           
# create a histogram using base graphics
hist(ages$age, xlab = "age (years)", las = 1)
```</code></pre>
<p>… which will render the graph:</p>
<div class="inline-figure"><img src="02-week02_files/figure-html/unnamed-chunk-4-1.png" width="672"></div>
</div>
<div id="ggplot2-graphics" class="section level4" number="2.2.2.2">
<h4>
<span class="header-section-number">2.2.2.2</span> <code>ggplot2</code> graphics<a class="anchor" aria-label="anchor" href="#ggplot2-graphics"><i class="fas fa-link"></i></a>
</h4>
<p>The <code>ggplot2</code> package creates compelling graphics that use a common syntax. The main difference between base R graphics and <code>ggplot2</code> graphics is that simply issuing the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> or related command (e.g., <code><a href="https://rdrr.io/r/graphics/hist.html">hist()</a></code>, <code><a href="https://rdrr.io/r/graphics/barplot.html">barplot()</a></code>) adds the graphic to the output, whereas with <code>ggplot()</code> it is necessary to issue a command that prints the graphic.</p>
<p>Following the previous example:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># how many unique bins? </span>
<span class="va">bins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">ages</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">)</span>

<span class="co"># create the graphic</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ages</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="va">bins</span><span class="op">)</span>

<span class="co"># print the graphic</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-week02_files/figure-html/unnamed-chunk-5-1.png" width="672"></div>
</div>
<div id="embedding-graphics-files" class="section level4" number="2.2.2.3">
<h4>
<span class="header-section-number">2.2.2.3</span> Embedding graphics files<a class="anchor" aria-label="anchor" href="#embedding-graphics-files"><i class="fas fa-link"></i></a>
</h4>
<p>Journals frequently require graphics files to be submitted separately from the manuscript. In this case, the graphic can be created and saved as a file and then inserted in the Rmd using code, but also accessed as a a stand-alone file. Let’s take the previous example, but add correlation coefficients and other embellishments, create a graphics file and add the graphics into the Rmd.</p>
<p>The base graphics file is created using the <code><a href="https://rdrr.io/r/grDevices/pdf.html">pdf()</a></code> function, although <code><a href="https://rdrr.io/r/grDevices/png.html">png()</a></code> also works if that is the desired output format. PDF is a vector format, so it generally renders better over different zoom levels.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"ah_age_hist.pdf"</span>, width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">ages</span><span class="op">$</span><span class="va">age</span>, xlab <span class="op">=</span> <span class="st">"age (years)"</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Here we create a PNG format file:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"ah_age_hist.png"</span>, width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">5</span>, units <span class="op">=</span> <span class="st">"in"</span>, res <span class="op">=</span> <span class="fl">300</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">ages</span><span class="op">$</span><span class="va">age</span>, xlab <span class="op">=</span> <span class="st">"age (years)"</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><code>ggplot2</code> graphics can be saved using <code>ggsave()</code>, e.g., for both PDF and PNG outputs. The <code>dpi</code> argument is important for bitmap images.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggsave</span><span class="op">(</span>
    filename <span class="op">=</span> <span class="st">"ah_age_hist_ggplot.pdf"</span>,
    plot <span class="op">=</span> <span class="va">g</span>, device <span class="op">=</span> <span class="st">"pdf"</span>,
    width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">5</span>
<span class="op">)</span>
<span class="fu">ggsave</span><span class="op">(</span>
    filename <span class="op">=</span> <span class="st">"ah_age_hist_ggplot.png"</span>,
    plot <span class="op">=</span> <span class="va">g</span>, device <span class="op">=</span> <span class="st">"png"</span>, 
    width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">5</span>, 
    units <span class="op">=</span> <span class="st">"in"</span>, dpi <span class="op">=</span> <span class="fl">300</span>
<span class="op">)</span></code></pre></div>
<p>Graphics can be added using several methods.</p>
<div id="knitr" class="section level5" number="2.2.2.3.1">
<h5>
<span class="header-section-number">2.2.2.3.1</span> <code>knitr</code><a class="anchor" aria-label="anchor" href="#knitr"><i class="fas fa-link"></i></a>
</h5>
<p>The <code><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">knitr::include_graphics()</a></code> function can be used to insert image files, with the caution that inserted PDF files may produce unwanted results. The syntax is:</p>
<pre><code>```{r}
include_graphics("graphics_filename")
```</code></pre>
<p>and the code chunk can include <code>out.width</code>, <code>out.height</code> and other options.
 
Here we insert a PDF with no code chunk options, which presents the image with a scroll bar, rather than the full image:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">include_graphics</span><span class="op">(</span><span class="st">"ah_age_hist.pdf"</span><span class="op">)</span></code></pre></div>
<p><embed src="ah_age_hist.pdf"></embed><!-- --></p>
<p>Here we specify in the code chunk options <code>out.height = "360px", out.width='360px', fig.align='left'</code>,</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">include_graphics</span><span class="op">(</span><span class="st">"ah_age_hist.pdf"</span><span class="op">)</span></code></pre></div>
<embed src="ah_age_hist.pdf" width="360px" height="360px" style="display: block; margin: auto auto auto 0;" type="application/pdf"></embed><p> </p>
<p>… and with code chunk options <code>out.height = "400px", out.width='100%', fig.align='left'</code></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">include_graphics</span><span class="op">(</span><span class="st">"ah_age_hist.pdf"</span><span class="op">)</span></code></pre></div>
<embed src="ah_age_hist.pdf" width="100%" height="400px" style="display: block; margin: auto auto auto 0;" type="application/pdf"></embed><p> </p>
<p>It seems that embedding PDF files is not optimal.</p>
<p>Here we insert a PNG: with no code chunk options:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">include_graphics</span><span class="op">(</span><span class="st">"ah_age_hist_ggplot.png"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="ah_age_hist_ggplot.png" width="750"></div>
<p>and with code chunk option <code>out.width = "50%"</code></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">include_graphics</span><span class="op">(</span><span class="st">"ah_age_hist_ggplot.png"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="ah_age_hist_ggplot.png" width="50%"></div>
<p>So embedding bitmapped images appears to work better than embedding PDF files.</p>
</div>
<div id="markdown-captionfilename" class="section level5" number="2.2.2.3.2">
<h5>
<span class="header-section-number">2.2.2.3.2</span> Markdown: <code>![caption](filename)</code><a class="anchor" aria-label="anchor" href="#markdown-captionfilename"><i class="fas fa-link"></i></a>
</h5>
<p>The native Markdown syntax:</p>
<pre><code>![](filename)</code></pre>
<p>includes a graphics file with an optional caption, e.g., here, a PDF with no caption,</p>
<p><code>![](ah_age_hist.pdf)</code></p>
<p><embed src="ah_age_hist.pdf"></embed></p>
<p> </p>
<p>The structure <code>![]()</code> indicates this is an inserted graphic; a caption can be specified by including text within the square brackets, e.g., displays the caption below the inserted image (but with no caption number!).</p>
<p><code>![Add Health respondent age histogram](ah_age_hist_ggplot.pdf)</code></p>
<div class="figure">
<embed src="ah_age_hist_ggplot.pdf"></embed><p class="caption">Add Health respondent age histogram</p>
</div>
<p>… although it seems that inserting a PDF does odd things with image scrolling, while a PNG inserts the complete image without scroll bars.</p>
<p><code>![Add Health respondent age histogram](ah_age_hist_ggplot.png)</code>:</p>
<div class="figure">
<img src="ah_age_hist_ggplot.png" alt=""><p class="caption">Add Health respondent age histogram</p>
</div>
</div>
<div id="html-img-tag" class="section level5" number="2.2.2.3.3">
<h5>
<span class="header-section-number">2.2.2.3.3</span> HTML <code>&lt;img&gt;</code> tag<a class="anchor" aria-label="anchor" href="#html-img-tag"><i class="fas fa-link"></i></a>
</h5>
<p>If the file is to be rendered as HTML, <em>and</em> the image is a bitmap, rather than vector PDF graphics, the <code>&lt;img&gt;</code> tag can be used. Different utilities can be used to convert PDF to bitmapped formats, e.g., <a href="https://imagemagick.org/index.php">ImageMagick</a> and <a href="http://www.graphicsmagick.org/">GraphicsMagick</a>.</p>
<p><code>&lt;img src="ah_age_hist_ggplot.png"&gt;</code></p>
<div class="inline-figure"><img src="ah_age_hist_ggplot.png"></div>
<p>Including a percentage of page width:</p>
<p><code>&lt;img src="ah_age_hist_ggplot.png" width="30%"&gt;</code></p>
<div class="inline-figure"><img src="ah_age_hist_ggplot.png" width="30%"></div>
</div>
</div>
</div>
<div id="rmdtables" class="section level3" number="2.2.3">
<h3>
<span class="header-section-number">2.2.3</span> Tables in R Markdown<a class="anchor" aria-label="anchor" href="#rmdtables"><i class="fas fa-link"></i></a>
</h3>
<p>We will look at three methods of including tables in R Markdown documents, using the packages <code>knitr</code> (with <code>kableExtra</code>), <code>pander</code>, and <code>stargazer</code>.</p>
<p>For the example table, we will use the frequency table of health <span class="math inline">\(\times\)</span> White and African American from Assignment 2:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">readstata13</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/readstata13/man/read.dta13.html">read.dta13</a></span><span class="op">(</span><span class="st">"http://staff.washington.edu/phurvitz/csde502_winter_2021/data/AHwave1_v1.dta"</span><span class="op">)</span>


<span class="co"># ordered factor; use fct_rev to establish the correct ordering where better health ranks higher</span>
<span class="va">dat</span> <span class="op">%&lt;&gt;%</span> 
    <span class="fu">mutate</span><span class="op">(</span>h1gh1 <span class="op">=</span> <span class="fu">fct_rev</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.ordered</a></span><span class="op">(</span><span class="va">h1gh1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># stratify health; first we need to catch the "don't know" and "refused" as NAs</span>
<span class="va">dat</span> <span class="op">%&lt;&gt;%</span>  
    <span class="fu">mutate</span><span class="op">(</span>health <span class="op">=</span> 
    <span class="fu">case_when</span><span class="op">(</span>
        <span class="va">h1gh1</span> <span class="op">&lt;=</span> <span class="st">"(6) Refused"</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>,
        <span class="va">h1gh1</span> <span class="op">&gt;</span>  <span class="st">"(3) Good"</span> <span class="op">~</span> <span class="st">"high"</span>,
        <span class="va">h1gh1</span> <span class="op">&lt;=</span> <span class="st">"(3) Good"</span> <span class="op">~</span> <span class="st">"low"</span>
    <span class="op">)</span><span class="op">)</span>

<span class="co"># tabulate by White</span>
<span class="va">tabhealth_white</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span> 
    <span class="fu">group_by</span><span class="op">(</span><span class="va">health</span>, white <span class="op">=</span> <span class="va">h1gi6a</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">summarise</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop_last"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">mutate</span><span class="op">(</span><span class="st">"%"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="co"># tabulate by African American</span>
<span class="va">tabhealth_afram</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span> 
    <span class="fu">group_by</span><span class="op">(</span><span class="va">health</span>, afram <span class="op">=</span> <span class="va">h1gi6b</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">summarise</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop_last"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">mutate</span><span class="op">(</span><span class="st">"%"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>

<span class="co"># column-bind and remove the second "health" column</span>
<span class="va">sum_health_white_afram</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">tabhealth_white</span>, <span class="va">tabhealth_afram</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<div id="kntir-kable-and-kableextra" class="section level4" number="2.2.3.1">
<h4>
<span class="header-section-number">2.2.3.1</span> <code>kntir</code> (<code>kable()</code>) and <code>kableExtra</code><a class="anchor" aria-label="anchor" href="#kntir-kable-and-kableextra"><i class="fas fa-link"></i></a>
</h4>
<p>The simple table using <code>kable()</code> is not too nice to read.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">kable</span><span class="op">(</span><span class="va">sum_health_white_afram</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
health…1
</th>
<th style="text-align:left;">
white
</th>
<th style="text-align:right;">
n…3
</th>
<th style="text-align:right;">
%…4
</th>
<th style="text-align:left;">
afram
</th>
<th style="text-align:right;">
n…7
</th>
<th style="text-align:right;">
%…8
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
1486
</td>
<td style="text-align:right;">
33.36
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
3309
</td>
<td style="text-align:right;">
74.28
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
2962
</td>
<td style="text-align:right;">
66.49
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
1139
</td>
<td style="text-align:right;">
25.57
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.04
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
704
</td>
<td style="text-align:right;">
34.49
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
1553
</td>
<td style="text-align:right;">
76.09
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
1328
</td>
<td style="text-align:right;">
65.07
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
479
</td>
<td style="text-align:right;">
23.47
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.39
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
50.00
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
50.00
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
25.00
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
25.00
</td>
</tr>
</tbody>
</table></div>
<p>So we add some <code>kabelExtra</code> options, :</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">kable</span><span class="op">(</span><span class="va">sum_health_white_afram</span>,
      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"health"</span>, <span class="st">"race"</span>, <span class="st">"n"</span>, <span class="st">"%"</span>, <span class="st">"race"</span>, <span class="st">"n"</span>, <span class="st">"%"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
        <span class="fu">kable_styling</span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span><span class="op">)</span>, full_width <span class="op">=</span> <span class="cn">F</span>, position <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span> </code></pre></div>
<div class="inline-table"><table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; ">
<thead><tr>
<th style="text-align:left;">
health
</th>
<th style="text-align:left;">
race
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
%
</th>
<th style="text-align:left;">
race
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
%
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
1486
</td>
<td style="text-align:right;">
33.36
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
3309
</td>
<td style="text-align:right;">
74.28
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
2962
</td>
<td style="text-align:right;">
66.49
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
1139
</td>
<td style="text-align:right;">
25.57
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.04
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
704
</td>
<td style="text-align:right;">
34.49
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
1553
</td>
<td style="text-align:right;">
76.09
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
1328
</td>
<td style="text-align:right;">
65.07
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
479
</td>
<td style="text-align:right;">
23.47
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.39
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
50.00
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
50.00
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
25.00
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
25.00
</td>
</tr>
</tbody>
</table></div>
<p>However, because some column names are duplicated, it is necessary to add some column grouping:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">kable</span><span class="op">(</span><span class="va">sum_health_white_afram</span>,
      col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"health"</span>, <span class="st">"race"</span>, <span class="st">"n"</span>, <span class="st">"%"</span>, <span class="st">"race"</span>, <span class="st">"n"</span>, <span class="st">"%"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">kable_styling</span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span><span class="op">)</span>, full_width <span class="op">=</span> <span class="cn">F</span>, position <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">add_header_above</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">" "</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"White"</span> <span class="op">=</span> <span class="fl">3</span>, <span class="st">"African American"</span> <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; ">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
White
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
African American
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
health
</th>
<th style="text-align:left;">
race
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
%
</th>
<th style="text-align:left;">
race
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
1486
</td>
<td style="text-align:right;">
33.36
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
3309
</td>
<td style="text-align:right;">
74.28
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
2962
</td>
<td style="text-align:right;">
66.49
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
1139
</td>
<td style="text-align:right;">
25.57
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.04
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
704
</td>
<td style="text-align:right;">
34.49
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
1553
</td>
<td style="text-align:right;">
76.09
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
1328
</td>
<td style="text-align:right;">
65.07
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
479
</td>
<td style="text-align:right;">
23.47
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.39
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
50.00
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
50.00
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
25.00
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
25.00
</td>
</tr>
</tbody>
</table></div>
<p>We could also add some row groupings:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sum_health_white_afram</span> <span class="op">%&gt;%</span> 
    <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">kable</span><span class="op">(</span>col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"race"</span>, <span class="st">"n"</span>, <span class="st">"%"</span>, <span class="st">"race"</span>, <span class="st">"n"</span>, <span class="st">"%"</span><span class="op">)</span>, align<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'r'</span>,times<span class="op">=</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">kable_styling</span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span><span class="op">)</span>, full_width <span class="op">=</span> <span class="cn">F</span>, position <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">add_header_above</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"White"</span> <span class="op">=</span> <span class="fl">3</span>, <span class="st">"African American"</span> <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">pack_rows</span><span class="op">(</span><span class="st">"health high"</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">pack_rows</span><span class="op">(</span><span class="st">"health low"</span>, <span class="fl">5</span>, <span class="fl">8</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">pack_rows</span><span class="op">(</span><span class="st">"health N/A"</span>, <span class="fl">9</span>, <span class="fl">12</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; ">
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
White
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
African American
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
race
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
%
</th>
<th style="text-align:right;">
race
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
%
</th>
</tr>
</thead>
<tbody>
<tr grouplength="4">
<td colspan="6" style="border-bottom: 1px solid;">
<strong>health high</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
1486
</td>
<td style="text-align:right;">
33.36
</td>
<td style="text-align:right;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
3309
</td>
<td style="text-align:right;">
74.28
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
2962
</td>
<td style="text-align:right;">
66.49
</td>
<td style="text-align:right;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
1139
</td>
<td style="text-align:right;">
25.57
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.04
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr grouplength="4">
<td colspan="6" style="border-bottom: 1px solid;">
<strong>health low</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
704
</td>
<td style="text-align:right;">
34.49
</td>
<td style="text-align:right;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
1553
</td>
<td style="text-align:right;">
76.09
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
1328
</td>
<td style="text-align:right;">
65.07
</td>
<td style="text-align:right;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
479
</td>
<td style="text-align:right;">
23.47
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.39
</td>
</tr>
<tr grouplength="4">
<td colspan="6" style="border-bottom: 1px solid;">
<strong>health N/A</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
<td style="text-align:right;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
50.00
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
50.00
</td>
<td style="text-align:right;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
<td style="text-align:right;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
25.00
</td>
<td style="text-align:right;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
25.00
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="stargazer" class="section level4" number="2.2.3.2">
<h4>
<span class="header-section-number">2.2.3.2</span> <code>stargazer</code><a class="anchor" aria-label="anchor" href="#stargazer"><i class="fas fa-link"></i></a>
</h4>
<p>The <a href="https://cran.r-project.org/web/packages/stargazer/vignettes/stargazer.pdf"><code>stargazer</code></a> package is especially good for PDF outputs, but is fairly limited for HTML output.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">stargazer</span><span class="op">(</span><span class="va">sum_health_white_afram</span>, 
          type <span class="op">=</span> <span class="st">"html"</span>, 
          summary <span class="op">=</span> <span class="cn">FALSE</span>,
          rownames <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table style="text-align:center" class="table table-sm">
<tr>
<td colspan="7" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
health…1
</td>
<td>
white
</td>
<td>
n…3
</td>
<td>
%…4
</td>
<td>
afram
</td>
<td>
n…7
</td>
<td>
%…8
</td>
</tr>
<tr>
<td colspan="7" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
high
</td>
<td>
1
</td>
<td>
1486
</td>
<td>
33.36
</td>
<td>
1
</td>
<td>
3309
</td>
<td>
74.28
</td>
</tr>
<tr>
<td style="text-align:left">
high
</td>
<td>
2
</td>
<td>
2962
</td>
<td>
66.49
</td>
<td>
2
</td>
<td>
1139
</td>
<td>
25.57
</td>
</tr>
<tr>
<td style="text-align:left">
high
</td>
<td>
3
</td>
<td>
2
</td>
<td>
0.04
</td>
<td>
3
</td>
<td>
2
</td>
<td>
0.04
</td>
</tr>
<tr>
<td style="text-align:left">
high
</td>
<td>
4
</td>
<td>
5
</td>
<td>
0.11
</td>
<td>
4
</td>
<td>
5
</td>
<td>
0.11
</td>
</tr>
<tr>
<td style="text-align:left">
low
</td>
<td>
1
</td>
<td>
704
</td>
<td>
34.49
</td>
<td>
1
</td>
<td>
1553
</td>
<td>
76.09
</td>
</tr>
<tr>
<td style="text-align:left">
low
</td>
<td>
2
</td>
<td>
1328
</td>
<td>
65.07
</td>
<td>
2
</td>
<td>
479
</td>
<td>
23.47
</td>
</tr>
<tr>
<td style="text-align:left">
low
</td>
<td>
3
</td>
<td>
1
</td>
<td>
0.05
</td>
<td>
3
</td>
<td>
1
</td>
<td>
0.05
</td>
</tr>
<tr>
<td style="text-align:left">
low
</td>
<td>
4
</td>
<td>
8
</td>
<td>
0.39
</td>
<td>
4
</td>
<td>
8
</td>
<td>
0.39
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
1
</td>
<td>
1
</td>
<td>
12.5
</td>
<td>
1
</td>
<td>
4
</td>
<td>
50
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
2
</td>
<td>
4
</td>
<td>
50
</td>
<td>
2
</td>
<td>
1
</td>
<td>
12.5
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
3
</td>
<td>
1
</td>
<td>
12.5
</td>
<td>
3
</td>
<td>
1
</td>
<td>
12.5
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
4
</td>
<td>
2
</td>
<td>
25
</td>
<td>
4
</td>
<td>
2
</td>
<td>
25
</td>
</tr>
<tr>
<td colspan="7" style="border-bottom: 1px solid black">
</td>
</tr>
</table></div>
</div>
<div id="pander" class="section level4" number="2.2.3.3">
<h4>
<span class="header-section-number">2.2.3.3</span> <code>pander</code><a class="anchor" aria-label="anchor" href="#pander"><i class="fas fa-link"></i></a>
</h4>
<p><code>pander</code> can be used to create output HTML tables as well, although also with fewer options than <code>knitr</code> with <code>kableExtra</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pander</span><span class="op">(</span><span class="va">sum_health_white_afram</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="16%">
<col width="21%">
<col width="10%">
<col width="10%">
<col width="21%">
<col width="10%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="center">health…1</th>
<th align="center">white</th>
<th align="center">n…3</th>
<th align="center">%…4</th>
<th align="center">afram</th>
<th align="center">n…7</th>
<th align="center">%…8</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">high</td>
<td align="center">(0) Not marked</td>
<td align="center">1486</td>
<td align="center">33.36</td>
<td align="center">(0) Not marked</td>
<td align="center">3309</td>
<td align="center">74.28</td>
</tr>
<tr class="even">
<td align="center">high</td>
<td align="center">(1) Marked</td>
<td align="center">2962</td>
<td align="center">66.49</td>
<td align="center">(1) Marked</td>
<td align="center">1139</td>
<td align="center">25.57</td>
</tr>
<tr class="odd">
<td align="center">high</td>
<td align="center">(6) Refused</td>
<td align="center">2</td>
<td align="center">0.04</td>
<td align="center">(6) Refused</td>
<td align="center">2</td>
<td align="center">0.04</td>
</tr>
<tr class="even">
<td align="center">high</td>
<td align="center">(8) Don’t know</td>
<td align="center">5</td>
<td align="center">0.11</td>
<td align="center">(8) Don’t know</td>
<td align="center">5</td>
<td align="center">0.11</td>
</tr>
<tr class="odd">
<td align="center">low</td>
<td align="center">(0) Not marked</td>
<td align="center">704</td>
<td align="center">34.49</td>
<td align="center">(0) Not marked</td>
<td align="center">1553</td>
<td align="center">76.09</td>
</tr>
<tr class="even">
<td align="center">low</td>
<td align="center">(1) Marked</td>
<td align="center">1328</td>
<td align="center">65.07</td>
<td align="center">(1) Marked</td>
<td align="center">479</td>
<td align="center">23.47</td>
</tr>
<tr class="odd">
<td align="center">low</td>
<td align="center">(6) Refused</td>
<td align="center">1</td>
<td align="center">0.05</td>
<td align="center">(6) Refused</td>
<td align="center">1</td>
<td align="center">0.05</td>
</tr>
<tr class="even">
<td align="center">low</td>
<td align="center">(8) Don’t know</td>
<td align="center">8</td>
<td align="center">0.39</td>
<td align="center">(8) Don’t know</td>
<td align="center">8</td>
<td align="center">0.39</td>
</tr>
<tr class="odd">
<td align="center">NA</td>
<td align="center">(0) Not marked</td>
<td align="center">1</td>
<td align="center">12.5</td>
<td align="center">(0) Not marked</td>
<td align="center">4</td>
<td align="center">50</td>
</tr>
<tr class="even">
<td align="center">NA</td>
<td align="center">(1) Marked</td>
<td align="center">4</td>
<td align="center">50</td>
<td align="center">(1) Marked</td>
<td align="center">1</td>
<td align="center">12.5</td>
</tr>
<tr class="odd">
<td align="center">NA</td>
<td align="center">(6) Refused</td>
<td align="center">1</td>
<td align="center">12.5</td>
<td align="center">(6) Refused</td>
<td align="center">1</td>
<td align="center">12.5</td>
</tr>
<tr class="even">
<td align="center">NA</td>
<td align="center">(8) Don’t know</td>
<td align="center">2</td>
<td align="center">25</td>
<td align="center">(8) Don’t know</td>
<td align="center">2</td>
<td align="center">25</td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div id="rmdcaptions" class="section level3" number="2.2.4">
<h3>
<span class="header-section-number">2.2.4</span> Captions to support tables, figures, and equations<a class="anchor" aria-label="anchor" href="#rmdcaptions"><i class="fas fa-link"></i></a>
</h3>
<p>There are several ways to support captions in R Markdown. The two main requirements for good captions: (1) automatic sequential numbering, and (2) ability to cross-reference.</p>
<p>Here are some options for adding captions:</p>
<div id="figures" class="section level4" number="2.2.4.1">
<h4>
<span class="header-section-number">2.2.4.1</span> Figures<a class="anchor" aria-label="anchor" href="#figures"><i class="fas fa-link"></i></a>
</h4>
<div id="r-markdown-code-chunk-fig.cap" class="section level5" number="2.2.4.1.1">
<h5>
<span class="header-section-number">2.2.4.1.1</span> R Markdown code chunk <code>fig.cap</code><a class="anchor" aria-label="anchor" href="#r-markdown-code-chunk-fig.cap"><i class="fas fa-link"></i></a>
</h5>
<p>Code chunks can include <code>fig_cap</code> as an option, as shown below. However, in standard Rmd <span class="math inline">\(\rightarrow\)</span> HTML there does not appear to be a method for cross-referencing. The code chunk would look like</p>
<pre><code>```{r plotcars, fig.cap="Cars: speed and distance"}
plot(cars)
```</code></pre>
<div class="figure">
<span style="display:block;" id="fig:plotcars"></span>
<img src="02-week02_files/figure-html/plotcars-1.png" alt="Cars: speed and distance" width="672"><p class="caption">
Figure 2.1: Cars: speed and distance
</p>
</div>
</div>
<div id="bookdown-with-html_document2-output-type" class="section level5" number="2.2.4.1.2">
<h5>
<span class="header-section-number">2.2.4.1.2</span> <code>bookdown</code> with <code>html_document2</code> output type<a class="anchor" aria-label="anchor" href="#bookdown-with-html_document2-output-type"><i class="fas fa-link"></i></a>
</h5>
<p>Using the <code>bookdown</code> package with <code>html_document2</code> output type, it is possible to cross-reference using the chunk name. For example, download and run this code <a href="files/fig_cap_bookdown.Rmd">fig_cap_bookdown.Rmd</a></p>
<p>Which renders a file:</p>
<div class="inline-figure"><img src="images/week03/fig_ref.png"></div>
<p>There seems to be no difference in the HTML output using</p>
<pre><code>output: 
    bookdown::html_document2:</code></pre>
<p>versus</p>
<pre><code>output: 
    html_document:</code></pre>
<p>so the former is suggested as one way to include captions that support cross-referencing.</p>
</div>
</div>
<div id="tables-kable-caption" class="section level4" number="2.2.4.2">
<h4>
<span class="header-section-number">2.2.4.2</span> Tables: <code>kable()</code> “caption”<a class="anchor" aria-label="anchor" href="#tables-kable-caption"><i class="fas fa-link"></i></a>
</h4>
<p>Tables created with <code>kable()</code> can include the <code>caption</code> option. For example:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">kable</span><span class="op">(</span>x <span class="op">=</span> <span class="va">sum_health_white_afram</span>, caption <span class="op">=</span> <span class="st">"Self-reported health by race"</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:unnamed-chunk-23">Table 2.1: </span>Self-reported health by race
</caption>
<thead><tr>
<th style="text-align:left;">
health…1
</th>
<th style="text-align:left;">
white
</th>
<th style="text-align:right;">
n…3
</th>
<th style="text-align:right;">
%…4
</th>
<th style="text-align:left;">
afram
</th>
<th style="text-align:right;">
n…7
</th>
<th style="text-align:right;">
%…8
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
1486
</td>
<td style="text-align:right;">
33.36
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
3309
</td>
<td style="text-align:right;">
74.28
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
2962
</td>
<td style="text-align:right;">
66.49
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
1139
</td>
<td style="text-align:right;">
25.57
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.04
</td>
</tr>
<tr>
<td style="text-align:left;">
high
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
704
</td>
<td style="text-align:right;">
34.49
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
1553
</td>
<td style="text-align:right;">
76.09
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
1328
</td>
<td style="text-align:right;">
65.07
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
479
</td>
<td style="text-align:right;">
23.47
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0.39
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
<td style="text-align:left;">
<ol start="0" style="list-style-type: decimal"><li>Not marked
</li></ol>
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
50.00
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
50.00
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Marked
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
<td style="text-align:left;">
<ol start="6" style="list-style-type: decimal"><li>Refused
</li></ol>
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
12.50
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
25.00
</td>
<td style="text-align:left;">
<ol start="8" style="list-style-type: decimal"><li>Don’t know
</li></ol>
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
25.00
</td>
</tr>
</tbody>
</table></div>
<p>But there appears to be no direct way of cross-referencing within standard Rmd <span class="math inline">\(\rightarrow\)</span> HTML.</p>
<div id="bookdown-with-html_document2-output-type-1" class="section level5" number="2.2.4.2.1">
<h5>
<span class="header-section-number">2.2.4.2.1</span> <code>bookdown</code> with <code>html_document2</code> output type<a class="anchor" aria-label="anchor" href="#bookdown-with-html_document2-output-type-1"><i class="fas fa-link"></i></a>
</h5>
<p>Similarly for figures, the <code>bookdown</code> package with <code>html_document2</code> output type, it is possible to cross-reference using the chunk name. For example, download and run this code <a href="files/table_cap_bookdown.Rmd">table_cap_bookdown.Rmd</a></p>
<p>Which renders a file:</p>
<div class="inline-figure"><img src="images/week03/tab_ref.png"></div>
</div>
</div>
</div>
<div id="equations-rmdequations" class="section level3" number="2.2.5">
<h3>
<span class="header-section-number">2.2.5</span> Equations {# rmdequations}<a class="anchor" aria-label="anchor" href="#equations-rmdequations"><i class="fas fa-link"></i></a>
</h3>
<p>Equations should be numbered in manuscripts. Using <code>bookdown</code> makes this quite easy. The equations themselves require <span class="math inline">\(\LaTeX\)</span> syntax. There are numerous web sites with examples and tutorials for creating mathematical expressions with <span class="math inline">\(\LaTeX\)</span> In this example, we include Einstein’s famous equation:</p>
<pre>
\begin{equation}
  E=mc^2
  (\#eq:emc)
\end{equation}
</pre>
<p>and the sum of squares:</p>
<pre>
\begin{equation}
  \sum_{i=1}^n i^2 = \frac{n(n+1)(2n+1)}{6}
  (\#eq:sumn)
\end{equation}
</pre>
<p>The label for the equation is set with <code>(\#eq:emc)</code> and can be referenced using <code>\@ref(eq:emc)</code>. Operationalized, we see:</p>
<p>Einstein’s equation, energy equals mass times the square of the speed of light is shown in <a href="week2.html#eq:emc">(2.1)</a>.</p>
<p><span class="math display" id="eq:emc">\[\begin{equation}
  E=mc^2
  \tag{2.1}
\end{equation}\]</span></p>
<p>To make a sum of squares of <em>n</em> first integers, see <a href="week2.html#eq:sumn">(2.2)</a>.</p>
<p><span class="math display" id="eq:sumn">\[\begin{equation}
  \sum_{i=1}^n i^2 = \frac{n(n+1)(2n+1)}{6}
  \tag{2.2}
\end{equation}\]</span></p>
</div>
<div id="captioner-for-any-captioning-and-cross-referencing-figures-and-tables" class="section level3" number="2.2.6">
<h3>
<span class="header-section-number">2.2.6</span> <code>captioner</code> for any captioning and cross-referencing figures and tables<a class="anchor" aria-label="anchor" href="#captioner-for-any-captioning-and-cross-referencing-figures-and-tables"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>captioner</code> package provides a flexible, albeit cumbersome, framework for captioning both tables and figures.</p>
<p>The R code to do this:</p>
<pre><code><a href="https://github.com/adletaw/captioner">library(captioner)
table_nums &lt;- captioner(prefix = "Table")
figure_nums &lt;- captioner(prefix = "Figure")</a></code></pre>
<p>The <code>table_nums()</code> and <code>figure_nums()</code> functions are used to create captions and cross-references, and are not tied to any specific figure or table, as is the case with <code>kable</code> table captions and R code chunk <code>fig.cap</code>.</p>
<p>A caption is created, e.g., for a figure:</p>
<p><code>`r figure_nums(name = "figname", caption = "My Caption")`</code></p>
<p>and referenced, e.g.,</p>
<p><code>`r figure_nums(name = "figname", display = "cite")`</code></p>
<p>It does not matter whether the reference precedes or comes after the caption itself.</p>
<p>Another benefit to using <code>captioner</code> is that the output can be formatted using markdown syntax. For example, to format the caption in italics, use underscores:</p>
<p><code>_`r figure_nums(name = "figname", caption = "My Caption")`_</code></p>
<p>Although this method requires a bit more coding, it allows great flexibility. A complete example:</p>
<p>As shown in figure 1, the distribution of age has a slight negative skew.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># how many unique bins? </span>
<span class="va">bins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">ages</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">)</span>

<span class="co"># create the graphic</span>
<span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ages</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="va">bins</span><span class="op">)</span>

<span class="co"># print the graphic</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-week02_files/figure-html/unnamed-chunk-24-1.png" width="288"></div>
<p><em>figure 1: Add Health age histogram</em></p>
<p>Similarly, we can present the same data as a frequency table, as shown in table 1.</p>
<p><em>table 1: Add Health age frequency table</em></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ages</span> <span class="op">%&gt;%</span> 
    <span class="fu">group_by</span><span class="op">(</span><span class="va">age</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">summarise</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">mutate</span><span class="op">(</span>cumsum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,
        <span class="st">"%"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,
        <span class="st">"cum %"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">kable</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">kable_styling</span><span class="op">(</span>bootstrap_options <span class="op">=</span> 
        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span><span class="op">)</span>, 
        full_width <span class="op">=</span> <span class="cn">F</span>, 
        position <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span> </code></pre></div>
<div class="inline-table"><table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; ">
<thead><tr>
<th style="text-align:right;">
age
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
cumsum
</th>
<th style="text-align:right;">
%
</th>
<th style="text-align:right;">
cum %
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
578
</td>
<td style="text-align:right;">
587
</td>
<td style="text-align:right;">
8.9
</td>
<td style="text-align:right;">
9.0
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
903
</td>
<td style="text-align:right;">
1490
</td>
<td style="text-align:right;">
13.9
</td>
<td style="text-align:right;">
22.9
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
1081
</td>
<td style="text-align:right;">
2571
</td>
<td style="text-align:right;">
16.6
</td>
<td style="text-align:right;">
39.5
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
1162
</td>
<td style="text-align:right;">
3733
</td>
<td style="text-align:right;">
17.9
</td>
<td style="text-align:right;">
57.4
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
1169
</td>
<td style="text-align:right;">
4902
</td>
<td style="text-align:right;">
18.0
</td>
<td style="text-align:right;">
75.4
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
1149
</td>
<td style="text-align:right;">
6051
</td>
<td style="text-align:right;">
17.7
</td>
<td style="text-align:right;">
93.1
</td>
</tr>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
389
</td>
<td style="text-align:right;">
6440
</td>
<td style="text-align:right;">
6.0
</td>
<td style="text-align:right;">
99.1
</td>
</tr>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
6483
</td>
<td style="text-align:right;">
0.7
</td>
<td style="text-align:right;">
99.7
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
6501
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:right;">
100.0
</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="empty"></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>UW CSDE 502 A Course Notes</strong>" was written by Phil Hurvitz. It was last built on 2022-01-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
