<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 10 Week 10 | UW CSDE 502 A Course Notes</title>
<meta name="author" content="Phil Hurvitz">
<meta name="description" content="Rendered at 2022-01-07 01:27:37 Topic:Odds and ends  This week’s lesson will cover a additional R odds and ends.  10.1 R Markdown to Microsoft Word Microsoft Word (“Word”), is used widely to...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 10 Week 10 | UW CSDE 502 A Course Notes">
<meta property="og:type" content="book">
<meta property="og:description" content="Rendered at 2022-01-07 01:27:37 Topic:Odds and ends  This week’s lesson will cover a additional R odds and ends.  10.1 R Markdown to Microsoft Word Microsoft Word (“Word”), is used widely to...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 10 Week 10 | UW CSDE 502 A Course Notes">
<meta name="twitter:description" content="Rendered at 2022-01-07 01:27:37 Topic:Odds and ends  This week’s lesson will cover a additional R odds and ends.  10.1 R Markdown to Microsoft Word Microsoft Word (“Word”), is used widely to...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.20/datatables.js"></script><link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">UW CSDE 502 A Course Notes</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction and Welcome!</a></li>
<li><a class="" href="week1.html"><span class="header-section-number">1</span> Week 1</a></li>
<li><a class="" href="week2.html"><span class="header-section-number">2</span> Week 2</a></li>
<li><a class="" href="week3.html"><span class="header-section-number">3</span> Week 3</a></li>
<li><a class="" href="week4.html"><span class="header-section-number">4</span> Week 4</a></li>
<li><a class="" href="week5.html"><span class="header-section-number">5</span> Week 5</a></li>
<li><a class="" href="week6.html"><span class="header-section-number">6</span> Week 6</a></li>
<li><a class="" href="week7.html"><span class="header-section-number">7</span> Week 7</a></li>
<li><a class="" href="week8.html"><span class="header-section-number">8</span> Week 8</a></li>
<li><a class="" href="week9.html"><span class="header-section-number">9</span> Week 9</a></li>
<li><a class="active" href="week10.html"><span class="header-section-number">10</span> Week 10</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/CSDE-UW/csde502-winter-2022">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="week10" class="section level1" number="10">
<h1>
<span class="header-section-number">10</span> Week 10<a class="anchor" aria-label="anchor" href="#week10"><i class="fas fa-link"></i></a>
</h1>
<p>Rendered at <tt>2022-01-07 01:27:37</tt></p>
<h2>
Topic:Odds and ends
<a class="anchor" aria-label="anchor" href="#week10"><i class="fas fa-link"></i></a>
</h2>
<p>This week’s lesson will cover a additional R odds and ends.</p>
<div id="r-markdown-to-microsoft-word" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> R Markdown to Microsoft Word<a class="anchor" aria-label="anchor" href="#r-markdown-to-microsoft-word"><i class="fas fa-link"></i></a>
</h2>
<p>Microsoft Word (“Word”), is used widely to document research. Because of its advanced word processing and “track changes” capabilities, it is commonly used for preparation of manuscripts. Using R to generate output for Word is often a tedious process (e.g., create CSV files <span class="math inline">\(\rightarrow\)</span> paste the contents <span class="math inline">\(\rightarrow\)</span> convert to table; export R graphics with <code><a href="https://rdrr.io/r/grDevices/png.html">png()</a></code> or <code>ggsave()</code> <span class="math inline">\(\rightarrow\)</span> insert the file).</p>
<p>RMarkdown can be used to generate Word documents. This should be thought of as a one-way operation. That is to say, when a team works on a manuscript using Word, the typical work flow is that the lead author creates the first draft. Other authors make changes to the document using tracked changes. When the manuscript circulates over all authors, the lead author decides which changes to accept and which to reject, resulting in a new version. The process continues until the group of authors agrees that the manuscript is ready for publication.</p>
<p>Unfortunately there is no backwards path to take an existing Word docx and regenerate an Rmd (e.g., after you and your colleagues made a lot of changes to the Word docx). Nevertheless using this method could save you some “busy work” time in Word, as well as to provide a common stylistic template for your R outputs if you will be generating Word documents.</p>
<p>To export to a Word document, the following work flow should be followed:</p>
<ol style="list-style-type: decimal">
<li>Create a bare-bones Rmd file that contains all of the elements you want in your output, but little actual content.</li>
<li>Render the Rmd file to a Word docx file.</li>
<li>Open the docx file in Word and make any stylistic changes <strong>using Word styles</strong> (see the workshop <a href="https://csde.washington.edu/workshop/microsoft-word-for-the-social-sciences/">Microsoft Word for the Social Sciences</a>)</li>
<li>Use the style-edited docx file as a template in the Rmd file.</li>
<li>Write your complete Rmd file with the content you want to have placed in the Word docx file and then render. The output docx file will have the same stylistic configuration as the template docx.</li>
</ol>
<p>A more detailed work flow:</p>
<p>To use Word output, first make a minimal RMarkdown document with Word output.</p>
<div class="inline-figure"><img src="images/week03/20200419_233754-C__Users_phurvitz_nextcloud_uw_csde_courses_msword_soc_sci_-_RStudio.png"></div>
<p>Save the Rmd file and knit to to Word.</p>
<div class="inline-figure"><img src="images/week03/20200419_233851-Window.png"></div>
<p>The output document will have the elements from the Rmd file.</p>
<div class="inline-figure"><img src="images/week03/20200419_234510-minimal.docx_%5BRead-Only%5D_%5BCompatibility_Mode%5D_-_Word.png"></div>
<p>The important part of this is that the Word document will have a number of styles. Make any changes to the styles or margins. This will become the template for the output containing the actual scientific content. <strong><em>Do not add, remove, or rename any styles in this document!</em></strong> Save a copy of the document with any stylistic changes.</p>
<p>For example, here are some changes to the header styles:</p>
<div class="inline-figure"><img src="images/week03/20200420_002233-Window.png"></div>
<p>Presumably, all of the styles in the output docx can be modified:</p>
<div class="inline-figure"><img src="images/week03/20210121_020407-Window.png"></div>
<p>After you have made any changes, save the file as a “template”:</p>
<div class="inline-figure"><img src="images/week03/20200419_235426-Save_As.png"></div>
<p>In the YAML header of the Rmd file with your scientific content, this construction, in which you specify the path name to the template document.</p>
<pre><code>output:
  word_document:  
    reference_docx: "template.docx"</code></pre>
<p>When the Rmd file is rendered to a Word document, the stylistic changes will be applied to the output. For example, just changing the head matter of the previous document and re-rendering shows that the heading styles were applied as defined.</p>
<div class="inline-figure"><img src="images/week03/20200420_002536-minimal.docx_%5BRead-Only%5D_%5BCompatibility_Mode%5D_-_Word.png"></div>
<p>Although this overall functionality is somewhat limited, if you do have some Rmd code that generates some scientific content, and you want to output to a Word document with predefined formats, this will save you some busy work of reformatting.</p>
</div>
<div id="r-markdown-output" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> R Markdown output<a class="anchor" aria-label="anchor" href="#r-markdown-output"><i class="fas fa-link"></i></a>
</h2>
<p>There are two different basic output formats available, document and presentation. As of this writing, the list of specific output types includes:</p>
<ul>
<li><code>beamer_presentation</code></li>
<li><code>context_document</code></li>
<li><code>github_document</code></li>
<li><code>html_document</code></li>
<li><code>ioslides_presentation</code></li>
<li><code>latex_document</code></li>
<li><code>md_document</code></li>
<li><code>odt_document</code></li>
<li><code>pdf_document</code></li>
<li><code>powerpoint_presentation</code></li>
<li><code>rtf_document</code></li>
<li><code>slidy_presentation</code></li>
<li><code>word_document</code></li>
</ul>
<p>Various packages can also specify their own output types, e.g., <code><a href="https://pkgs.rstudio.com/bookdown/reference/html_document2.html">bookdown::html_document2</a></code> or `tufte::tufte_html.</p>
<div id="r-markdown-rendering-to-specific-formats" class="section level3" number="10.2.1">
<h3>
<span class="header-section-number">10.2.1</span> R Markdown rendering to specific formats<a class="anchor" aria-label="anchor" href="#r-markdown-rendering-to-specific-formats"><i class="fas fa-link"></i></a>
</h3>
<p>Rendering R Markdown files is done at the R console using the <code><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html">rmarkdown::render()</a></code> function, e.g.,</p>
<pre><code>rmarkdown::render(input = "input_filename.Rmd")</code></pre>
<p>or by clicking the <code>Knit</code> control in RSTudio.</p>
<p>If the YAML header specifies multiple output formats, the first listed format will be used for the output if other options are not specified in the <code>render()</code> function call. For example, for this header, the default output format is <code><a href="https://pkgs.rstudio.com/bookdown/reference/html_document2.html">bookdown::html_document2</a></code></p>
<pre><code>---
title: "A Document"
author: "Jane Doe"
date: "2021-01-23"
output: 
    bookdown::html_document2: default
    pdf_document: default
    html_document: default
    word_document: default
---</code></pre>
<p>The RStudio interface will present the listed choices in the <code>Knit</code> pick list in the GUI, so the desired output format can be selected interactively:</p>
<div class="inline-figure"><img src="../images/week03/20210124_010442-C__Users_phurvitz_OneDrive_uw_courses_csde502_csde502_winter_2021_course%20-%20RStud.png" class="border1"></div>
<p>Other supported outputs can be created, including those that are not listed in the YAML header by specifying the output format in the <code>render()</code> function, e.g. to create a <a href="https://www.w3.org/Talks/Tools/Slidy2/#(1)">Slidy</a> presentation:</p>
<pre><code>rmarkdown::render(input = "input_filename.Rmd", output_format = "slidy_presentation")</code></pre>
<p>To render a PDF file, use e.g.,</p>
<pre><code>rmarkdown::render(input = "input_filename.Rmd", output_format = "pdf_document")</code></pre>
<p>Using code rather than the RStudio GUI allows more flexible automation; you could have an R script that runs the <code>render()</code> function as part of a multi-step workflow. For example, if you had a continuous data collection process, the work flow could be coded and run with <a href="https://www.rdocumentation.org/packages/cronR">cron</a> to generate a new PDF (or other file type) file on a daily basis.</p>
</div>
<div id="testing-output_type" class="section level3" number="10.2.2">
<h3>
<span class="header-section-number">10.2.2</span> Testing <code>output_type()</code><a class="anchor" aria-label="anchor" href="#testing-output_type"><i class="fas fa-link"></i></a>
</h3>
<p>Because different output formats support (or do not support) different features, a test can be made for the output format to determine which code to run, using <code>is_html_output()</code> and <code>is_latex_output()</code>. Any R code within the Rmd file can be run or not run based on these tests. For a working example, download and render the file <a href="files/output_type_test.Rmd">output_type_test</a>. Using a single source, the <a href="files/output_type_test.html">output rendered as HTML</a> appears as</p>
<div class="inline-figure"><img src="images/week03/20210124_190945-R%20Markdown%20Output%20Type%20Test%20-%20Work%20-%20MicrosoftEdge.png"></div>
<p>whereas the <a href="files/output_type_test.pdf">PDF output</a> is rendered as</p>
<div class="inline-figure"><img src="images/week03/20210124_191706-output_type_test.pdf%20-%20%5BR%20Markdown%20Output%20Type%20Test%5D%20-%20SumatraPDF.png"></div>
<p>There appears to be no similar test for MS Word output, so for creating Word documents from Rmd files, it is suggested to create the Rmd from scratch with the intention of creating only Word output.</p>
</div>
</div>
<div id="advantages-and-disadvantages-of-pdf" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> Advantages and disadvantages of PDF<a class="anchor" aria-label="anchor" href="#advantages-and-disadvantages-of-pdf"><i class="fas fa-link"></i></a>
</h2>
<p>Portable document format (PDF) has a number of advantages:</p>
<ol style="list-style-type: decimal">
<li>Document formatting is maintained. Font face and positioning of elements is consistent. When some other formats are shared (e.g., MS Word), formatting is inconsistent.</li>
<li>The format is widely used and able to be created from a variety of different proprietary and open software applications.</li>
<li>Files are often parsimonious in size. When large images are embedded, the file sizes can grow, but there are often options for down-sampling images for smaller file size.</li>
<li>Files can be protected with passwords.</li>
<li>Files are supported across all operating systems (Windows, Mac, Linux, UNIX).</li>
<li>Multiple different elements can be included (text, images, tables).</li>
<li>The format has stood the test of time, having been introduced 1993. The standard was opened in 2008, allowing developers to create PDF outputs. This has led to PDF being the standard for fixed-format documents.</li>
</ol>
<p>The disadvantages:
1. Direct editing of PDF files is not straightforward (usually requires dedicated software), and often results in undesired layout changes. Therefore this is not a good format for collaborative editing.
1. Copy-and-paste from PDF often results in missing or extra spaces or strange characters.
1. R functions that produce HTML output cannot be used in PDF outputs.</p>
</div>
<div id="bibliography-in-r-markdown" class="section level2" number="10.4">
<h2>
<span class="header-section-number">10.4</span> Bibliography in R Markdown<a class="anchor" aria-label="anchor" href="#bibliography-in-r-markdown"><i class="fas fa-link"></i></a>
</h2>
<p>The <code>pandoc</code> engine that performs document conversion can generate bibliographies. See <a href="https://rmarkdown.rstudio.com/authoring_bibliographies_and_citations.html">Bibliographies and Citations</a> for detailed information.</p>
<p>For this exercise, we will be using <span class="math inline">\({B\kern-0.1emi\kern-0.017emb}\kern-0.15em\TeX\)</span> formatted references.</p>
<p>The YAML header needs to be formatted to include the bibliography file, which should either have a complete path name or be located in the same directory as the Rmd file. Similarly, any CSL (Citation Style Language) file should be specified. CSL files can be obtained from the <a href="https://www.zotero.org/styles">Zotero Style Repository</a></p>
<p>The YAML header would include something of the form:</p>
<pre><code>---
title: "My glorious, shiny dissertation"
output: 
    bookdown::html_document2
bibliography: myreferences_20200121.bib
csl: biomed-central.csl
---</code></pre>
<p>When citations are made to references, the corresponding record will be automatically added to the end of the document.</p>
<p>For examples of syntax for both APA-like and AMA-like references and bibliographies, see the files</p>
<ul>
<li>APA: <a href="files/bibliography.html">HTML</a>; <a href="files/bibliography.Rmd">Rmd</a>
</li>
<li>AMA: <a href="files/bibliography_ama.html">HTML</a>; <a href="files/bibliography_ama.Rmd">Rmd</a>
</li>
</ul>
<h4>
Source code for this document
<a class="anchor" aria-label="anchor" href="#bibliography-in-r-markdown"><i class="fas fa-link"></i></a>
</h4>
<p><a href="10-week10.Rmd">10-week10.Rmd</a></p>
<div class="sourceCode" id="cb540"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span><span class="op">(</span>con <span class="op">=</span> <span class="st">"10-week10.Rmd"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></code></pre></div>
<pre><code>Warning in readLines(con = "10-week10.Rmd"): incomplete final line found on '10-
week10.Rmd'</code></pre>
<pre><code># Week 10 {#week10}

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(magrittr)
library(knitr)
library(kableExtra)
library(haven)
library(curl)
library(ggplot2)

# URL home
urlhome &lt;- ""
```

Rendered at &lt;tt&gt;`r Sys.time()`&lt;/tt&gt;

&lt;h2&gt;Topic:Odds and ends&lt;/h2&gt;
This week's lesson will cover a additional R odds and ends.

## R Markdown to Microsoft Word
Microsoft Word ("Word"), is used widely to document research. Because of its advanced word processing and "track changes" capabilities, it is commonly used for preparation of manuscripts. Using R to generate output for Word is often a tedious process (e.g., create CSV files $\rightarrow$ paste the contents $\rightarrow$ convert to table; export R graphics with `png()` or `ggsave()` $\rightarrow$ insert the file).  

RMarkdown can be used to generate Word documents. This should be thought of as a one-way operation. That is to say, when a team works on a manuscript using Word, the typical work flow is that the lead author creates the first draft. Other authors make changes to the document using tracked changes. When the manuscript circulates over all authors, the lead author decides which changes to accept and which to reject, resulting in a new version. The process continues until the group of authors agrees that the manuscript is ready for publication.

Unfortunately there is no backwards path to take an existing Word docx and regenerate an Rmd (e.g., after you and your colleagues made a lot of changes to the Word docx). Nevertheless using this method could save you some "busy work" time in Word, as well as to provide a common stylistic template for your R outputs if you will be generating Word documents.

To export to a Word document, the following work flow should be followed:

1. Create a bare-bones Rmd file that contains all of the elements you want in your output, but little actual content.
1. Render the Rmd file to a Word docx file.
1. Open the docx file in Word and make any stylistic changes __using Word styles__ (see the workshop  [Microsoft Word for the Social Sciences](https://csde.washington.edu/workshop/microsoft-word-for-the-social-sciences/))
1. Use the style-edited docx file as a template in the Rmd file.
1. Write your complete Rmd file with the content you want to have placed in the Word docx file and then render. The output docx file will have the same stylistic configuration as the template docx.

A more detailed work flow:

To use Word output, first make a minimal RMarkdown document with Word output. 

![](images/week03/20200419_233754-C__Users_phurvitz_nextcloud_uw_csde_courses_msword_soc_sci_-_RStudio.png) 

Save the Rmd file and knit to to Word.

![](images/week03/20200419_233851-Window.png) 

The output document will have the elements from the Rmd file.

![](images/week03/20200419_234510-minimal.docx_[Read-Only]_[Compatibility_Mode]_-_Word.png) 

The important part of this is that the Word document will have a number of styles. Make any changes to the styles or margins. This will become the template for the output containing the actual scientific content. ___Do not add, remove, or rename any styles in this document!___ Save a copy of the document with any stylistic changes. 

For example, here are some changes to the header styles:

![](images/week03/20200420_002233-Window.png) 

Presumably, all of the styles in the output docx can be modified:

![](images/week03/20210121_020407-Window.png)

After you have made any changes, save the file as a "template":

![](images/week03/20200419_235426-Save_As.png)

In the YAML header of the Rmd file with your scientific content, this construction, in which you specify the path name to the template document.

```
output:
  word_document:  
    reference_docx: "template.docx"
```

When the Rmd file is rendered to a Word document, the stylistic changes will be applied to the output. For example, just changing the head matter of the previous document and re-rendering shows that the heading styles were applied as defined.

![](images/week03/20200420_002536-minimal.docx_[Read-Only]_[Compatibility_Mode]_-_Word.png)

Although this overall functionality is somewhat limited, if you do have some Rmd code that generates some scientific content, and you want to output to a Word document with predefined formats, this will save you some busy work of reformatting.

## R Markdown output 
There are two different basic output formats available, document and presentation. As of this writing, the list of specific output types includes:

* `beamer_presentation`
* `context_document`
* `github_document`
* `html_document`
* `ioslides_presentation`
* `latex_document`
* `md_document`
* `odt_document`
* `pdf_document`
* `powerpoint_presentation`
* `rtf_document`
* `slidy_presentation`
* `word_document`

Various packages can also specify their own output types, e.g., `bookdown::html_document2` or `tufte::tufte_html.

### R Markdown rendering to specific formats
Rendering R Markdown files is done at the R console using the `rmarkdown::render()` function, e.g., 

```
rmarkdown::render(input = "input_filename.Rmd")
```

or by clicking the `Knit` control in RSTudio.

If the YAML header specifies multiple output formats, the first listed format will be used for the output if  other options are not specified in the `render()` function call. For example, for this header, the default output format is `bookdown::html_document2`

```
---
title: "A Document"
author: "Jane Doe"
date: "2021-01-23"
output: 
    bookdown::html_document2: default
    pdf_document: default
    html_document: default
    word_document: default
---
```

The RStudio interface will present the listed choices in the `Knit` pick list in the GUI, so the desired output format can be selected interactively:

&lt;img src="../images/week03/20210124_010442-C__Users_phurvitz_OneDrive_uw_courses_csde502_csde502_winter_2021_course - RStud.png" class="border1"&gt;

Other supported outputs can be created, including those that are not listed in the YAML header by specifying the output format in the `render()` function, e.g. to create a [Slidy](https://www.w3.org/Talks/Tools/Slidy2/#(1)) presentation: 

```
rmarkdown::render(input = "input_filename.Rmd", output_format = "slidy_presentation")
```

To render a PDF file, use e.g., 

```
rmarkdown::render(input = "input_filename.Rmd", output_format = "pdf_document")
```

Using code rather than the RStudio GUI allows more flexible automation; you could have an R script that runs the `render()` function as part of a multi-step workflow. For example, if you had a continuous data collection process, the work flow could be coded and run with [cron](https://www.rdocumentation.org/packages/cronR) to generate a new PDF (or other file type) file on a daily basis.

### Testing `output_type()`
Because different output formats support (or do not support) different features, a test can be made for the output format to determine which code to run, using `is_html_output()` and `is_latex_output()`. Any R code within the Rmd file can be run or not run based on these tests. For a working example, download and render the file [output_type_test](files/output_type_test.Rmd). Using a single source, the [output rendered as HTML](files/output_type_test.html) appears as

![](images/week03/20210124_190945-R Markdown Output Type Test - Work - MicrosoftEdge.png)

whereas the [PDF output](files/output_type_test.pdf) is rendered as

![](images/week03/20210124_191706-output_type_test.pdf - [R Markdown Output Type Test] - SumatraPDF.png)

There appears to be no similar test for MS Word output, so for creating Word documents from Rmd files, it is suggested to create the Rmd from scratch with the intention of creating only Word output.

## Advantages and disadvantages of PDF
Portable document format (PDF) has a number of advantages:

1. Document formatting is maintained. Font face and positioning of elements is consistent. When some other formats are shared (e.g., MS Word), formatting is inconsistent. 
1. The format is widely used and able to be created from a variety of different proprietary and open software applications.
1. Files are often parsimonious in size. When large images are embedded, the file sizes can grow, but there are often options for down-sampling images for smaller file size.
1. Files can be protected with passwords.
1. Files are supported across all operating systems (Windows, Mac, Linux, UNIX).
1. Multiple different elements can be included (text, images, tables).
1. The format has stood the test of time, having been introduced 1993. The standard was opened in 2008, allowing developers to create PDF outputs. This has led to PDF being the standard for fixed-format documents. 

The disadvantages:
1. Direct editing of PDF files is not straightforward (usually requires dedicated software), and often results in undesired layout changes. Therefore this is not a good format for collaborative editing.
1. Copy-and-paste from PDF often results in missing or extra spaces or strange characters.
1. R functions that produce HTML output cannot be used in PDF outputs.

## Bibliography in R Markdown
The `pandoc` engine that performs document conversion can generate bibliographies. See [Bibliographies and Citations](https://rmarkdown.rstudio.com/authoring_bibliographies_and_citations.html) for detailed information.

For this exercise, we will be using ${B\kern-0.1emi\kern-0.017emb}\kern-0.15em\TeX$ formatted references.

The YAML header needs to be formatted to include the bibliography file, which should either have a complete path name or be located in the same directory as the Rmd file. Similarly, any CSL (Citation Style Language) file should be specified. CSL files can be obtained from the [Zotero Style Repository
](https://www.zotero.org/styles)

The YAML header would include something of the form:

```
---
title: "My glorious, shiny dissertation"
output: 
    bookdown::html_document2
bibliography: myreferences_20200121.bib
csl: biomed-central.csl
---
```

When citations are made to references, the corresponding record will be automatically added to the end of the document.

For examples of syntax for both APA-like and AMA-like references and bibliographies, see the files 

* APA: [HTML](files/bibliography.html); [Rmd](files/bibliography.Rmd)
* AMA: [HTML](files/bibliography_ama.html); [Rmd](files/bibliography_ama.Rmd)

&lt;h4&gt;Source code for this document&lt;/h4&gt;
[10-week10.Rmd](10-week10.Rmd)

```{r comment=''}
cat(readLines(con = "10-week10.Rmd"), sep = "\n")
```</code></pre>

</div>
</div>






  <div class="chapter-nav">
<div class="prev"><a href="week9.html"><span class="header-section-number">9</span> Week 9</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#week10"><span class="header-section-number">10</span> Week 10</a></li>
<li><a class="nav-link" href="#week10">
Topic:Odds and ends
</a></li>
<li><a class="nav-link" href="#r-markdown-to-microsoft-word"><span class="header-section-number">10.1</span> R Markdown to Microsoft Word</a></li>
<li>
<a class="nav-link" href="#r-markdown-output"><span class="header-section-number">10.2</span> R Markdown output</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#r-markdown-rendering-to-specific-formats"><span class="header-section-number">10.2.1</span> R Markdown rendering to specific formats</a></li>
<li><a class="nav-link" href="#testing-output_type"><span class="header-section-number">10.2.2</span> Testing output_type()</a></li>
</ul>
</li>
<li><a class="nav-link" href="#advantages-and-disadvantages-of-pdf"><span class="header-section-number">10.3</span> Advantages and disadvantages of PDF</a></li>
<li><a class="nav-link" href="#bibliography-in-r-markdown"><span class="header-section-number">10.4</span> Bibliography in R Markdown</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/CSDE-UW/csde502-winter-2022/blob/master/10-week10.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/CSDE-UW/csde502-winter-2022/edit/master/10-week10.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>UW CSDE 502 A Course Notes</strong>" was written by Phil Hurvitz. It was last built on 2022-01-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
